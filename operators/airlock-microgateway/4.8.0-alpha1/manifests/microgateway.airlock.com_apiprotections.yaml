apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
  labels:
    app.kubernetes.io/name: airlock-microgateway-operator
    app.kubernetes.io/version: 4.8.0-alpha1
  name: apiprotections.microgateway.airlock.com
spec:
  group: microgateway.airlock.com
  names:
    categories:
    - airlock-microgateway
    kind: APIProtection
    listKind: APIProtectionList
    plural: apiprotections
    singular: apiprotection
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: |-
          APIProtection defines a rule-based policy for enforcing API conformance via e.g., OpenAPI or GraphQL validation.
          Different schemas can be applied to different paths based on request conditions.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: spec defines the desired API protection configuration.
            properties:
              policies:
                description: policies defines the policies for API protection of downstream
                  requests.
                items:
                  properties:
                    graphQLRef:
                      description: |-
                        graphQLRef enables and configures GraphQL validation for requests matching this policy.
                        If undefined, default settings are applied, designed to work with most upstream web application services.
                      properties:
                        name:
                          description: name of the resource
                          maxLength: 253
                          minLength: 1
                          type: string
                      required:
                      - name
                      type: object
                    name:
                      description: name describing the configured policy. Must be
                        unique.
                      maxLength: 256
                      minLength: 1
                      type: string
                    noValidation:
                      description: noValidation disables API protection for requests
                        matching this policy.
                      type: object
                    openAPIRef:
                      description: |-
                        openAPIRef enables and configures OpenAPI validation for requests matching this policy.
                        If undefined, default settings are applied, designed to work with most upstream web application services.
                      properties:
                        name:
                          description: name of the resource
                          maxLength: 253
                          minLength: 1
                          type: string
                      required:
                      - name
                      type: object
                    requestConditions:
                      description: requestConditions defines additional request properties
                        which must all be matched in order for this policy to apply.
                      properties:
                        header:
                          description: header defines the matching headers of a request.
                          properties:
                            name:
                              description: name defines the name of a header.
                              properties:
                                matcher:
                                  description: matcher defines the way to match a
                                    string. In comparison to a normal StringMatcher,
                                    a value is always matched ignoring the case and
                                    can't be inverted.
                                  properties:
                                    contains:
                                      description: |-
                                        contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                        Only one of exact, prefix, suffix, regex or contains can be set.
                                      maxLength: 1024
                                      minLength: 1
                                      type: string
                                    exact:
                                      description: |-
                                        exact defines an explicit match on the string specified here.
                                        Only one of exact, prefix, suffix, regex or contains can be set.
                                      maxLength: 1024
                                      minLength: 1
                                      type: string
                                    prefix:
                                      description: |-
                                        prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                        Only one of exact, prefix, suffix, regex or contains can be set.
                                      maxLength: 1024
                                      minLength: 1
                                      type: string
                                    regex:
                                      description: |-
                                        regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                        The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                        Only one of exact, prefix, suffix, regex or contains can be set.
                                      maxLength: 1024
                                      minLength: 1
                                      type: string
                                    suffix:
                                      description: |-
                                        suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                        Only one of exact, prefix, suffix, regex or contains can be set.
                                      maxLength: 1024
                                      minLength: 1
                                      type: string
                                  type: object
                              required:
                              - matcher
                              type: object
                            value:
                              description: value defines the value of a header.
                              properties:
                                matcher:
                                  description: StringMatcher defines the way to match
                                    a string.
                                  properties:
                                    contains:
                                      description: |-
                                        contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                        Only one of exact, prefix, suffix, regex or contains can be set.
                                      maxLength: 1024
                                      minLength: 1
                                      type: string
                                    exact:
                                      description: |-
                                        exact defines an explicit match on the string specified here.
                                        Only one of exact, prefix, suffix, regex or contains can be set.
                                      maxLength: 1024
                                      minLength: 1
                                      type: string
                                    ignoreCase:
                                      default: false
                                      description: ignoreCase indicates whether the
                                        matching should be case-insensitive. In case
                                        of a regex match, the regex gets wrapped with
                                        a group `(?i:...)`.
                                      type: boolean
                                    prefix:
                                      description: |-
                                        prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                        Only one of exact, prefix, suffix, regex or contains can be set.
                                      maxLength: 1024
                                      minLength: 1
                                      type: string
                                    regex:
                                      description: |-
                                        regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                        The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                        Only one of exact, prefix, suffix, regex or contains can be set.
                                      maxLength: 1024
                                      minLength: 1
                                      type: string
                                    suffix:
                                      description: |-
                                        suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                        Only one of exact, prefix, suffix, regex or contains can be set.
                                      maxLength: 1024
                                      minLength: 1
                                      type: string
                                  type: object
                              required:
                              - matcher
                              type: object
                          type: object
                        invert:
                          default: false
                          description: invert indicates whether the request condition
                            should be inverted.
                          type: boolean
                        mediaType:
                          description: mediaType defines the matching media type from
                            the content-type header of a request.
                          properties:
                            matcher:
                              description: |-
                                NonInvertableCaseInsensitiveStringMatcher defines the way to match a string.
                                In comparison to a normal StringMatcher, a value is always matched ignoring the case and can't be inverted.
                              properties:
                                contains:
                                  description: |-
                                    contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                  maxLength: 1024
                                  minLength: 1
                                  type: string
                                exact:
                                  description: |-
                                    exact defines an explicit match on the string specified here.
                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                  maxLength: 1024
                                  minLength: 1
                                  type: string
                                prefix:
                                  description: |-
                                    prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                  maxLength: 1024
                                  minLength: 1
                                  type: string
                                regex:
                                  description: |-
                                    regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                    The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                  maxLength: 1024
                                  minLength: 1
                                  type: string
                                suffix:
                                  description: |-
                                    suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                  maxLength: 1024
                                  minLength: 1
                                  type: string
                              type: object
                          required:
                          - matcher
                          type: object
                        method:
                          description: method defines the matching methods of a request.
                          items:
                            description: Method defines common HTTP methods.
                            enum:
                            - GET
                            - HEAD
                            - POST
                            - PUT
                            - PATCH
                            - DELETE
                            - CONNECT
                            - OPTIONS
                            - TRACE
                            type: string
                          maxItems: 16
                          type: array
                          x-kubernetes-list-type: set
                        path:
                          description: path defines the matching path of a request.
                          properties:
                            matcher:
                              description: StringMatcher defines the way to match
                                a string.
                              properties:
                                contains:
                                  description: |-
                                    contains defines a substring match on the substring specified here. Empty contains match is not allowed, please use regex instead.
                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                  maxLength: 1024
                                  minLength: 1
                                  type: string
                                exact:
                                  description: |-
                                    exact defines an explicit match on the string specified here.
                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                  maxLength: 1024
                                  minLength: 1
                                  type: string
                                ignoreCase:
                                  default: false
                                  description: ignoreCase indicates whether the matching
                                    should be case-insensitive. In case of a regex
                                    match, the regex gets wrapped with a group `(?i:...)`.
                                  type: boolean
                                prefix:
                                  description: |-
                                    prefix defines a prefix match on the prefix specified here. Empty prefix is not allowed, please use regex instead.
                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                  maxLength: 1024
                                  minLength: 1
                                  type: string
                                regex:
                                  description: |-
                                    regex defines a regex match on the regular expression specified here. Google's [RE2 regex engine](https://github.com/google/re2/wiki/Syntax) is used.
                                    The regex matches only single-line by default, even with ".*". To match a multi-line string prepend (?s) to your regex.
                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                  maxLength: 1024
                                  minLength: 1
                                  type: string
                                suffix:
                                  description: |-
                                    suffix defines a suffix match on the suffix specified here. Empty suffix is not allowed, please use regex instead.
                                    Only one of exact, prefix, suffix, regex or contains can be set.
                                  maxLength: 1024
                                  minLength: 1
                                  type: string
                              type: object
                          required:
                          - matcher
                          type: object
                        remoteIP:
                          description: |-
                            remoteIP defines the matching remote IPs of a request.
                            Note: Depending on your setup you may need to adapt the `remoteIP` configuration in the `SidecarGateway` / `GatewayParameters` resource to ensure correct client IP detection.
                          properties:
                            cidrRanges:
                              description: cidrRanges defines the IPv4 or IPv6 CIDR
                                ranges, e.g. ``196.148.3.128/26`` or ``2001:db8::/28``.
                              items:
                                description: CIDRRange defines an IPv4 or IPv6 CIDR
                                  range, e.g. “196.148.3.128/26“ or “2001:db8::/28“.
                                format: cidr
                                maxLength: 49
                                minLength: 1
                                type: string
                              maxItems: 1024
                              minItems: 1
                              type: array
                              x-kubernetes-list-type: set
                            invert:
                              default: false
                              description: invert indicates whether the match should
                                be inverted.
                              type: boolean
                          required:
                          - cidrRanges
                          type: object
                      type: object
                  required:
                  - name
                  type: object
                maxItems: 128
                type: array
                x-kubernetes-list-map-keys:
                - name
                x-kubernetes-list-type: map
            type: object
        type: object
    served: true
    storage: true
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: null
  storedVersions: null

apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  creationTimestamp: null
  name: fepclusters.fep.fujitsu.io
spec:
  conversion:
    strategy: None
  group: fep.fujitsu.io
  names:
    kind: FEPCluster
    listKind: FEPClusterList
    plural: fepclusters
    shortNames:
    - fep
    singular: fepcluster
  scope: Namespaced
  versions:
  - name: v2
    schema:
      openAPIV3Schema:
        description: FEPCluster is the Schema for the fepclusters API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          fepStatus:
            description: Status defines the observed state of FEPCluster
            type: object
            x-kubernetes-preserve-unknown-fields: true
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: Specification of the desired state of FEPCluster
            properties:
              fep:
                properties:
                  autoPodRestart:
                    description: Optional. This parameter affects the behaviour when
                      value(s) of CPU, memory and/or image for FEP and/or optional
                      Backup container are updated in FEPCluster CR. If it is NOT
                      defined or set to True, operator will automatically create an
                      action CR to make values effective by restarting all pods in
                      an orderly fashion to minmise outage. If is set to False, automatic
                      restart of PODs will NOT happen. To make the changes effective,
                      user must restart pods by creating action CR with type pod_restart
                      and arguments ALL
                    type: boolean
                  autoTuning:
                    description: Common settings for the FEP autotuning function
                    properties:
                      prometheus:
                        description: Configuring to Connect to Prometheus
                        properties:
                          authSecret:
                            description: This is Optional section. Authentication
                              secret
                            properties:
                              passwordKey:
                                description: Mandatory Key of password in specified
                                  secret
                                type: string
                              proxyKey:
                                description: Mandatory Key of proxy in specified secret
                                type: string
                              secretName:
                                description: Mandatory Name of secret that contains
                                  username and password
                                type: string
                              tokenKey:
                                description: Mandatory Key of token in specified secret
                                type: string
                              userKey:
                                description: Mandatory Key of username in specified
                                  secret
                                type: string
                            type: object
                          maxRetry:
                            description: Maximum connection attempts
                            type: integer
                          prometheusUrl:
                            description: URL of Prometheus
                            type: string
                          tls:
                            description: tls section for Prometheus
                            properties:
                              caName:
                                description: This points to Kubernetes configmap that
                                  contains additional CA for Prometheus to verify
                                  client. The CA is stored in the key ca.crt
                                type: string
                              certificateName:
                                description: This point to Kubernetes TLS secret that
                                  contains the certificate for Prometheus. The certificate
                                  itself is stored in the key tls.crt
                                type: string
                            type: object
                        type: object
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  backupStats:
                    description: Define a schedule for backing up statistics
                    properties:
                      enable:
                        description: Enable statistics backup schedule
                        type: boolean
                      image:
                        description: Cronjob image backing up statistics.
                        type: string
                      pullPolicy:
                        description: Pull policy for cronjob image
                        enum:
                        - Always
                        - IfNotPresent
                        type: string
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  customAnnotations:
                    description: Custom annotations to be added to dependent resources.
                    properties:
                      allDeployments:
                        additionalProperties:
                          type: string
                          x-kubernetes-preserve-unknown-fields: true
                        description: Contents under this are optional. User can remove
                          {} and add multiple key-value pairs. All of these pair will
                          be added to annotations of FEP statefulSet and FEP Pods.
                          If left at default, no annotation is added to Pods and statefulSets
                        type: object
                    type: object
                  databaseSize:
                    description: Simplify defining machine specifications for database
                      containers
                    enum:
                    - small
                    - medium
                    - large
                    type: string
                  fepVersion:
                    description: Optional field to specify FEP Server version to be
                      used. If not specified, operator uses latest FEP Server version
                      to pickup FEP Server image.
                    type: integer
                  feputils:
                    description: feputils side-car container parameters
                    properties:
                      PullPolicy:
                        description: Pull policy for fep utils image.
                        enum:
                        - Always
                        - IfNotPresent
                        type: string
                      image:
                        description: URL for feputils image; if not specified, URL
                          for feputils is fetched from operator environment variable
                        type: string
                    type: object
                  fineTuningParams:
                    description: Control Patroni timer
                    properties:
                      loop_wait:
                        description: the number of seconds the loop will sleep.
                        type: integer
                      master_start_timeout:
                        description: the amount of time a primary is allowed to recover
                          from failures before failover is triggered (in seconds).
                        type: integer
                      master_stop_timeout:
                        description: The number of seconds Patroni is allowed to wait
                          when stopping Postgres and effective only when synchronous_mode
                          is enabled.
                        type: integer
                      retry_timeout:
                        description: timeout for DCS and PostgreSQL operation retries
                          (in seconds). DCS or network issues shorter than this will
                          not cause Patroni to demote the leader.
                        type: integer
                      ttl:
                        description: the TTL to acquire the leader lock (in seconds).
                          Think of it as the length of time before initiation of the
                          automatic failover process.
                        type: integer
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  fixedStats:
                    description: Defines the schedule for fixing statistics and where
                      to store statistics
                    properties:
                      endpoint:
                        description: Object storage containing statistics
                        properties:
                          authentication:
                            description: Authentication for accessing object storage
                              Secret containing sensitive information.
                            type: string
                          protocol:
                            description: Vendor of object storage with statistics.
                            enum:
                            - s3
                            - blob
                            - gcs
                            - local
                            type: string
                        type: object
                      image:
                        description: Statistics Specifies the container image of the
                          Cronjob to be pinned.
                        type: string
                      pullPolicy:
                        description: Pull policy for cronjob image
                        enum:
                        - Always
                        - IfNotPresent
                        type: string
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  forceSsl:
                    description: Setting this to true will force FEP Server to only
                      accept SSL connection. Changes are reflected in pg_hba.conf
                    type: boolean
                  image:
                    description: FEP Server image definition
                    properties:
                      image:
                        description: It is optional. Image line is omitted by default.
                          In such a case, it will pick up URL of image from operator
                          container environment. If you specify the image, Operator
                          will take that image to deploy fep container
                        type: string
                      pullPolicy:
                        description: Pull policy for fep server image
                        enum:
                        - Always
                        - IfNotPresent
                        type: string
                    type: object
                  instances:
                    description: Number of nodes in the cluster, including both Master
                      and Replicas. Default is 1. However, user can change it to 3
                      for 1 master and 2 replicas.
                    minimum: 1
                    type: integer
                  mcSpec:
                    description: resource specifications for fep-patroni container
                    properties:
                      limits:
                        description: Limits of allocated resources
                        properties:
                          cpu:
                            default: 500m
                            description: cpu limit for fep-patroni container
                            pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(m|[Ee][-+]?[0-9]+)?$
                            x-kubernetes-preserve-unknown-fields: true
                          memory:
                            default: 700Mi
                            description: memory limit for fep-patroni container
                            pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(([kmKMGTPE])|([KMGTPE]i)|([Ee][+-]?([0-9]+)))?$
                            x-kubernetes-preserve-unknown-fields: true
                        type: object
                      requests:
                        description: Initial request of allocated resources
                        properties:
                          cpu:
                            default: 200m
                            description: cpu request
                            pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(m|[Ee][-+]?[0-9]+)?$
                            x-kubernetes-preserve-unknown-fields: true
                          memory:
                            default: 512Mi
                            description: memory request
                            pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(([kmKMGTPE])|([KMGTPE]i)|([Ee][+-]?([0-9]+)))?$
                            x-kubernetes-preserve-unknown-fields: true
                        type: object
                    type: object
                  monitoring:
                    description: This is an Optional section. This defines whether
                      monitoring enabled(true) or disabled(false) , MTLS enabled or
                      disabled & Basic authentication enabled or not
                    properties:
                      enable:
                        description: This flag enables the monitoring function. If
                          set to true, Postgres metric will be exposed via fep-exporter.
                        type: boolean
                      fepExporter:
                        description: This is Optional section. Exporter spec section
                          applied only if enable is set to true
                        properties:
                          authSecret:
                            description: 'This is Optional section. Base Authentication
                              secret to provide username & encrypted password of user.
                              Ref: https://github.com/prometheus/exporter-toolkit/blob/master/docs/web-configuration.md
                              for details.'
                            properties:
                              passwordKey:
                                description: 'Mandatory: Key in specified secret that
                                  contains the password '
                                type: string
                              secretName:
                                description: 'Mandatory: Name of secret that contains
                                  username and password'
                                type: string
                              userKey:
                                description: 'Mandatory: Key in specified secret that
                                  contains the username'
                                type: string
                            type: object
                          customLabel:
                            description: Array of custom labels for fepexporter to
                              be used in ServiceMonitor and PrometheusRule
                            items:
                              additionalProperties:
                                type: string
                              type: object
                            type: array
                          tls:
                            description: 'This is optional section. FEPExporter MTLS
                              specs. Mandatory if tls specs defined for Prometheus
                              specs. Ref: https://github.com/prometheus/exporter-toolkit/blob/master/docs/web-configuration.md
                              for details.'
                            properties:
                              caName:
                                description: Mandatory This points to Kubernetes configmap
                                  that contains additional CA the client use to verify
                                  a server certificate. The CA is stored in the key
                                  ca.crt.
                                type: string
                              certificateName:
                                description: Mandatory.This points to Kubernetes TLS
                                  secret that contains the certificate of FepExporter.
                                  Prometheus will use this for certificate authentication.
                                  The certificate itself is stored in the key tls.crt.
                                type: string
                            type: object
                        type: object
                      prometheus:
                        description: This is Optional section. Prometheus specs are
                          mandatory if tls specs defined for FEPExporter
                        properties:
                          tls:
                            description: Prometheus MTLS specs
                            properties:
                              caName:
                                description: This is an Optional parameter. This point
                                  to Kubernetes configmap that contains additional
                                  CA the client use to verify a server certificate.
                                  The CA is stored in the key ca.crt.
                                type: string
                              certificateName:
                                description: This is an Optional parameter. These
                                  points to Kubernetes TLS secret that contains the
                                  certificate of Prometheus. FEPExporter will use
                                  this for certificate authentication. The certificate
                                  itself is stored in the key tls.crt.
                                type: string
                            type: object
                        type: object
                    type: object
                  patroni:
                    description: patroni mtls configuration
                    properties:
                      tls:
                        description: TLS configuration for patroni
                        properties:
                          caName:
                            description: This points to Kubernetes configmap that
                              contains additional CA for Patroni to verify client.
                              The CA is stored in the key ca.crt
                            type: string
                          certificateName:
                            description: This point to Kubernetes TLS secret that
                              contains the certificate for Patroni. The certificate
                              itself is stored in the key tls.crt
                            type: string
                          verifyClient:
                            description: Whether Patroni will verify clients certificate
                            type: string
                        type: object
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  pgAuditLog:
                    description: This is an Optional section. To forward audit logs
                      to external storage
                    properties:
                      auditLogPath:
                        description: log directory for audit logs. This should be
                          same as fepChildCrVal.customPgAudit.log_directory
                        type: string
                      config:
                        description: ConfigMap name for pgAudit config file. The ConfigMap
                          needs to have a key pgaudit.conf.
                        type: string
                      enable:
                        description: This will enable pgaudit extension in postgresql.conf.
                        type: boolean
                      endpoint:
                        description: 'Endpoint properties for uploading the auditlog
                          files. File name: endpoint.conf Format: key=value'
                        properties:
                          authentication:
                            description: |-
                              Optional: A secret containing authentication info to access endpoint. The end user creates and provides the secret here.  For http protocol, create the secret with: basic_auth: <basic-credentials>  # as defined in RFC7617, https://www.ietf.org/rfc/rfc7617.txt
                              For s3 protocol, create the secret with: aws_access_key: <AWS Access Key ID> aws_access_secret: <AWS Secret Access Key>
                              For blob protocol, create the secret with: azure_storage_account_name: <Azure Storage Account Name> azure_storage_account_key: <Azure Storage Account Key>
                            type: string
                          azureBlobName:
                            description: When protocol is blob, specify the name of
                              Azure Blob for uploading auditlog files.
                            type: string
                          azureContainerName:
                            description: When protocol is blob, specify the name of
                              Container within Azure Storage Account for uploading
                              aduitlog files.
                            type: string
                          customCertificateName:
                            description: 'Optional: If the endpoint uses certificate
                              authentication, this points to a secret that  contains
                              the certificate to authenticate to the endpoint. Must
                              be defined in spec.fepChildCrVal.customCertificates.username.
                              If not defined, certificate will not be used when uploading
                              file'
                            type: string
                          fileUploadParameter:
                            description: 'Optional: The file upload parameter defined
                              by the web server. If defined, it will be passed to
                              the curl command as: curl -F ${fileUploadParameter}=@file_to_upload
                              $url.'
                            type: string
                          insecure:
                            description: 'Optional: equivalent to curl --insecure,
                              default to false'
                            type: boolean
                          protocol:
                            description: Protocol of endpoint. Supported values are
                              http for http(s) endpoint, s3 for S3 endpoint and blob
                              for Azure Blob storage.
                            enum:
                            - http
                            - s3
                            - blob
                            type: string
                          url:
                            description: The endpoint url to upload auditlog files
                              to. When protocol is http, specify in the format https://my.webserver/fep/auditlog
                              When protocol is s3, specify in the format s3://my-bucket.s3.us-west-2.amazonaws.com
                            type: string
                        type: object
                        x-kubernetes-preserve-unknown-fields: true
                      schedules:
                        description: Set in pgAuditLog cron job template
                        properties:
                          upload:
                            description: A ‘upload’ schedule to upload logs to endpoint,
                              in the format of cron schedule. e.g. * 5 * * * will
                              upload auditlog files at 5am daily
                            type: string
                        type: object
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  pgBadger:
                    description: This is an Optional section. Defines how pgBadger
                      runs and processes logs generated
                    properties:
                      endpoint:
                        description: Endpoint properties for uploading the report
                          file.
                        properties:
                          authentication:
                            description: 'Optional: A secret to contain authentication
                              info to access endpoint. The end user creates and provides
                              the secret here'
                            type: string
                          customCertificateName:
                            description: 'Optional: The item must be defined in spec.fepChildCrVal.customCertificates.username.
                              If not defined, certificate will not be used when uploading
                              file'
                            type: string
                          fileUploadParameter:
                            description: 'Optional: The file upload parameter defined
                              by the web server'
                            type: string
                          insecure:
                            description: 'Optional: equivalent to curl --insecure,
                              default to false'
                            type: boolean
                          url:
                            description: Endpoint url
                            type: string
                        type: object
                        x-kubernetes-preserve-unknown-fields: true
                      options:
                        description: 'Optional sub-section: defines optional flags
                          and parameters for pgBadger'
                        properties:
                          incremental:
                            description: If set to true, pgBadger will process newer
                              logs since last run. Otherwise all logs are processed
                            type: boolean
                        type: object
                        x-kubernetes-preserve-unknown-fields: true
                      schedules:
                        description: Set in pgBadger cron job template
                        properties:
                          cleanup:
                            description: Cron expression to run cleanup job
                            type: string
                          create:
                            description: Cron expression to run pgBadger to process
                              logs
                            type: string
                        type: object
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  podAntiAffinity:
                    description: 'If True, it defines that multiple pods should not
                      run on same worker node '
                    type: boolean
                  podDisruptionBudget:
                    description: If set True, it defines disruption budget that maximum
                      one node can be unavailable at a time
                    type: boolean
                  postgres:
                    description: Postgres MTLS section
                    properties:
                      tls:
                        description: TLS configuration for postgres
                        properties:
                          caName:
                            description: This points to Kubernetes configmap that
                              contains additional CA for Postgres to verify client.
                              The CA is stored in the key ca.crt
                            type: string
                          certificateName:
                            description: This point to Kubernetes TLS secret that
                              contains the certificate for Postgres. The certificate
                              itself is stored in the key tls.crt
                            type: string
                          privateKeyPassword:
                            description: This points to Kubernetes secret that contains
                              the password for the above private key
                            type: string
                          verifyClient:
                            description: Whether Postgres will verify clients certificate
                            type: string
                        type: object
                    type: object
                  remoteLogging:
                    description: Optional. This section defines remoteLogging configuration
                      to send log to Fluentd
                    properties:
                      enable:
                        description: This flag enables remoteLogging(Log forwarding
                          to fluentd) functionality. If enabled, adds fluentbit sidecar
                          for log forwarding.
                        type: boolean
                      fluentbitParams:
                        description: fluentbit config parameters
                        properties:
                          memBufLimit:
                            description: optional Memory buffer size limit
                            pattern: ^([0-9.]+)([KMG]B)$
                            type: string
                        type: object
                        x-kubernetes-preserve-unknown-fields: true
                      fluentdName:
                        description: Fluentd cr name to which log will be forwarded
                          to.
                        type: string
                      image:
                        description: Optional url for fluentbit image to be used.
                          If omitted, operator will pick up URL of the image from
                          operator container environment.
                        type: string
                      mcSpec:
                        description: resource specifications for fep-fluentbit container
                        properties:
                          limits:
                            description: Resource Limit section for fluentbit container
                            properties:
                              cpu:
                                description: cpu limit
                                pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(m|[Ee][-+]?[0-9]+)?$
                                x-kubernetes-preserve-unknown-fields: true
                              memory:
                                description: memory limit
                                pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(([kmKMGTPE])|([KMGTPE]i)|([Ee][+-]?([0-9]+)))?$
                                x-kubernetes-preserve-unknown-fields: true
                            type: object
                          requests:
                            description: Resource Request for fluentbit container
                            properties:
                              cpu:
                                description: cpu request
                                pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(m|[Ee][-+]?[0-9]+)?$
                                x-kubernetes-preserve-unknown-fields: true
                              memory:
                                description: memory request
                                pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(([kmKMGTPE])|([KMGTPE]i)|([Ee][+-]?([0-9]+)))?$
                                x-kubernetes-preserve-unknown-fields: true
                            type: object
                        type: object
                      pullPolicy:
                        description: Pull policy for fluentbit image
                        enum:
                        - Always
                        - IfNotPresent
                        type: string
                      tls:
                        description: This field defines tls section
                        properties:
                          caName:
                            description: This points to Kubernetes configmap that
                              contains additional CA the client use to verify a server
                              certificate. The CA is stored in the key ca.crt.
                            type: string
                          certificateName:
                            description: This points to Kubernetes TLS secret that
                              contains the certificate of fluetbit . FEPLogging will
                              use this for certificate authentication. The certificate
                              itself is stored in the key tls.crt.
                            type: string
                        type: object
                        x-kubernetes-preserve-unknown-fields: true
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  replicationSlots:
                    description: To configure custom replication slots to be used
                      for logical replication. These slots are retained after deletion
                      of subscription and can be reused. This field holds the required
                      properly formatted string
                    type: string
                    x-kubernetes-preserve-unknown-fields: true
                  servicePort:
                    description: TCP port for FEP service
                    type: integer
                  standby:
                    description: Standby FEPCluster definition
                    properties:
                      enable:
                        description: Setting this to true will deploy this FEPCluster
                          as a Standby of an existing cluster.
                        type: boolean
                      gcpRepoKeySecretName:
                        description: 'If the backup repository is on Google Cloud
                          Storage, specify the secret that has the credentials to
                          access the storage. '
                        type: string
                        x-kubernetes-preserve-unknown-fields: true
                      method:
                        description: Method to create Standby cluster. Can be either
                          archive-recovery or streaming. Both methods will first restore
                          the files from backup repository. With archive-recovery,
                          the cluster will fetch archived WAL files from backup repository
                          and continue the recovery process. With steaming, the cluster
                          will establish a replication connection with the Primary
                          cluster and continue streaming replication.
                        enum:
                        - archive-recovery
                        - streaming
                        type: string
                      pgBackrestConf:
                        description: Required for both archive-recovery and streaming
                          method. Specify the pgbackrest parameter pointing to the
                          repository where the database will be restored from. This
                          should match the pgbackrest parameters of the source cluster.
                        type: string
                      streaming:
                        description: Define the source cluster for streaming replication.
                        properties:
                          host:
                            description: FQDN or IP address of source cluster replicating
                              from.
                            type: string
                          port:
                            description: TCP port of source cluster replicating from.
                            type: integer
                        type: object
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  sysExtraEvent:
                    description: Set to True to turn on extra events.
                    type: boolean
                  sysExtraLogging:
                    description: Set to True to turn on debugging log.
                    type: boolean
                  usePodName:
                    description: Setting this key to true will make internal POD communication,
                      both Patroni and Postgres to use hostname, instead of IP address
                    type: boolean
                type: object
                x-kubernetes-preserve-unknown-fields: true
              fepChildCrVal:
                description: fepChildCR section
                properties:
                  backup:
                    description: Backup container section
                    properties:
                      image:
                        description: Backup container image
                        properties:
                          image:
                            description: It is optional. Image line is omitted by
                              default. In such a case, it will pick up URL of image
                              from operator container environment.If you specify the
                              image, Operator will take that image to deploy backup
                              container
                            type: string
                          pullPolicy:
                            description: Pull policy for backup container
                            enum:
                            - Always
                            - IfNotPresent
                            type: string
                        type: object
                      mcSpec:
                        description: Backup container resources
                        properties:
                          limits:
                            description: Limit section for backup container resources
                            properties:
                              cpu:
                                description: cpu limit
                                pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(m|[Ee][-+]?[0-9]+)?$
                                x-kubernetes-preserve-unknown-fields: true
                              memory:
                                description: memory limit
                                pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(([kmKMGTPE])|([KMGTPE]i)|([Ee][+-]?([0-9]+)))?$
                                x-kubernetes-preserve-unknown-fields: true
                            type: object
                          requests:
                            description: request for resources
                            properties:
                              cpu:
                                description: cpu request
                                pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(m|[Ee][-+]?[0-9]+)?$
                                x-kubernetes-preserve-unknown-fields: true
                              memory:
                                description: memory request
                                pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(([kmKMGTPE])|([KMGTPE]i)|([Ee][+-]?([0-9]+)))?$
                                x-kubernetes-preserve-unknown-fields: true
                            type: object
                        type: object
                      pgbackrestParams:
                        description: ' the parameter set in pgbackrest.conf'
                        type: string
                      postScript:
                        default: '" "'
                        description: contains the contents of the script to be executed
                          after the backup
                        type: string
                      preScript:
                        default: '" "'
                        description: contains the contents of the script to be executed
                          after the backup
                        type: string
                      repoKeySecretName:
                        description: Storage-account-secret for GCP
                        x-kubernetes-preserve-unknown-fields: true
                      schedule:
                        description: backup schedule
                        properties:
                          num:
                            description: Number of Schedule to set
                            type: integer
                        type: object
                      schedule1:
                        description: backup schedule
                        properties:
                          schedule:
                            description: backup cron
                            type: string
                          type:
                            description: type of backup. either full on incr
                            enum:
                            - full
                            - incr
                            type: string
                        type: object
                        x-kubernetes-preserve-unknown-fields: true
                      schedule2:
                        description: backup schedule
                        properties:
                          schedule:
                            description: backup schedule cron
                            type: string
                          type:
                            description: type of backup .either full or incr
                            enum:
                            - full
                            - incr
                            type: string
                        type: object
                        x-kubernetes-preserve-unknown-fields: true
                      schedule3:
                        description: backup schedule
                        x-kubernetes-preserve-unknown-fields: true
                      schedule4:
                        description: backup schedule
                        x-kubernetes-preserve-unknown-fields: true
                      schedule5:
                        description: backup schedule
                        x-kubernetes-preserve-unknown-fields: true
                      type:
                        description: Backup Type
                        enum:
                        - local
                        type: string
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  customCertificates:
                    description: array of elements to define certificates. Used to
                      setup SSL connection between publisher and subscriber clusters
                      for logical replication
                    items:
                      properties:
                        caName:
                          description: This points to Kubernetes configmap that contains
                            CA certificate to verify server. The CA is stored in the
                            key ca.crt
                          type: string
                        certificateName:
                          description: This points to Kubernetes TLS secret that contains
                            the custom certificate. The certificate itself is stored
                            in the key tls.crt
                          type: string
                        userName:
                          description: This should be the username of the publisher
                            database. When this parameter is specified, an empty folder
                            is created under FEP Server Container- /tmp/custom_certs/<username>.  The
                            custom certificates are mounted in this empty folder.
                            However, if this parameter is not specified, the section
                            is ignored and folder is not created; hence the certificates
                            are not mounted without it
                          type: string
                      type: object
                      x-kubernetes-preserve-unknown-fields: true
                    type: array
                    x-kubernetes-preserve-unknown-fields: true
                  customPgAudit:
                    description: PgAudit configuration.
                    type: string
                  customPgHba:
                    description: Entries to be inserted into pg_hba.conf
                    type: string
                  customPgParams:
                    description: Postgres configuration in postgresql.conf
                    type: string
                  secretStore:
                    description: cloud key management feature definition
                    properties:
                      csi:
                        description: csi definition
                        properties:
                          awsProvider:
                            description: aws Provider definition
                            properties:
                              fepCustomCert:
                                description: List of custom certificates used for
                                  this provider
                                items:
                                  properties:
                                    userCa:
                                      description: Name of secret where CA is stored
                                      type: string
                                    userCrt:
                                      description: Name of secret where client certificate
                                        is stored
                                      type: string
                                    userName:
                                      description: Name of user
                                      type: string
                                  type: object
                                type: array
                              fepSecrets:
                                description: containing mappings of secrets
                                x-kubernetes-preserve-unknown-fields: true
                              region:
                                description: AWS region
                                type: string
                              roleName:
                                description: AWS role mapping access to keyvault
                                type: string
                            type: object
                          azureProvider:
                            description: azure Provider definition
                            properties:
                              credentials:
                                description: Secret name containing azure vault principal
                                  secret and client id
                                type: string
                              fepCustomCert:
                                description: List of custom certificates used for
                                  this provider
                                items:
                                  properties:
                                    userCa:
                                      description: Name of secret where CA is stored
                                      type: string
                                    userCrt:
                                      description: Name of secret where client certificate
                                        is stored
                                      type: string
                                    userName:
                                      description: Name of user
                                      type: string
                                  type: object
                                type: array
                              fepSecrets:
                                description: containing mappings of secrets
                                x-kubernetes-preserve-unknown-fields: true
                              keyvaultname:
                                description: Azure keyvault name
                                type: string
                              tenantid:
                                description: Tenant id of azure keyvault
                                type: string
                            type: object
                          gcpProvider:
                            description: gcp Provider definition
                            properties:
                              credentials:
                                description: Secret name containing user id and password
                                  to connect to gcp keyvault
                                type: string
                              fepCustomCert:
                                description: List of custom certificates used for
                                  this provider
                                items:
                                  properties:
                                    userCa:
                                      description: Name of secret where CA is stored
                                      type: string
                                    userCrt:
                                      description: Name of secret where client certificate
                                        is stored
                                      type: string
                                    userName:
                                      description: Name of user
                                      type: string
                                  type: object
                                type: array
                              fepSecrets:
                                description: containing mappings of secrets
                                x-kubernetes-preserve-unknown-fields: true
                            type: object
                          providerName:
                            description: provider name for csi
                            enum:
                            - azure
                            - gcp
                            - aws
                            - vault
                            type: string
                          vaultProvider:
                            description: HashiCorp Vault Provider definition
                            properties:
                              fepCustomCert:
                                description: List of custom certificates used for
                                  this provider
                                items:
                                  properties:
                                    userCa:
                                      description: Name of secret where CA is stored
                                      type: string
                                    userCrt:
                                      description: Name of secret where client certificate
                                        is stored
                                      type: string
                                    userName:
                                      description: Name of user
                                      type: string
                                  type: object
                                type: array
                              fepSecrets:
                                description: containing mappings of secrets
                                x-kubernetes-preserve-unknown-fields: true
                              roleName:
                                description: AWS role mapping access to keyvault
                                type: string
                              vaultAddress:
                                description: vault ip address
                                type: string
                            type: object
                        type: object
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  storage:
                    description: Storage definition
                    properties:
                      accessModes:
                        description: ' accessModes for Volumes with no accessModes
                          defined: Specified as an array of accessModes e.g. [ReadWriteMany].
                          If omitted, it will be treated as [ReadWriteOnce]'
                        items:
                          type: string
                        type: array
                      archivewalVol:
                        description: Archive volume section
                        properties:
                          accessModes:
                            description: ' accessModes for archive volume: Specified
                              as an array of accessModes e.g. [ReadWriteMany]. If
                              omitted, it will be treated as [ReadWriteOnce]'
                            items:
                              type: string
                            type: array
                          increase:
                            description: PVC Expansion Amount
                            type: integer
                          increaseType:
                            description: Method for estimating PVC expansion amount
                            enum:
                            - percent
                            - size
                            type: string
                          size:
                            default: 1Gi
                            description: Size of archive volume.The storage volumes
                              size can be increased provided underlying storage supports
                              the operation
                            pattern: ^(\d+(e\d+)?|\d+(\.\d+)?(e\d+)?[EPTGMK]i?)$
                            type: string
                          storageClass:
                            description: 'StorageClass for archive volume: When this
                              line is omitted, the PV created will use default storage
                              class in the Kubernetes cluster'
                            type: string
                          storageLimit:
                            description: PVC Expansion Limit
                            type: integer
                          threshold:
                            description: Threshold for starting PVC expansion
                            type: integer
                        type: object
                      autoresize:
                        description: Defining PVC Extensions
                        properties:
                          enable:
                            description: Enable pvc expand feature by setting enable
                              to true
                            type: boolean
                          increase:
                            description: PVC Expansion Amount
                            type: integer
                          increaseType:
                            description: Method for estimating PVC expansion amount
                            enum:
                            - percent
                            - size
                            type: string
                          interval:
                            description: PVC Usage Check Interval
                            type: integer
                          mcSpec:
                            description: resource specifications for pvc-auto-resize
                              container
                            properties:
                              limits:
                                description: limits for cpu
                                properties:
                                  cpu:
                                    description: cpu limit for fep-patroni container
                                    pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(m|[Ee][-+]?[0-9]+)?$
                                    x-kubernetes-preserve-unknown-fields: true
                                  memory:
                                    description: memory limit for fep-patroni container
                                    pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(([kmKMGTPE])|([KMGTPE]i)|([Ee][+-]?([0-9]+)))?$
                                    x-kubernetes-preserve-unknown-fields: true
                                type: object
                              requests:
                                description: resource request for fep-patroni container
                                properties:
                                  cpu:
                                    description: cpu request
                                    pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(m|[Ee][-+]?[0-9]+)?$
                                    x-kubernetes-preserve-unknown-fields: true
                                  memory:
                                    description: memory request
                                    pattern: ^(([0-9]+(\.[0-9]+)?)|(\.[0-9]+))(([kmKMGTPE])|([KMGTPE]i)|([Ee][+-]?([0-9]+)))?$
                                    x-kubernetes-preserve-unknown-fields: true
                                type: object
                            type: object
                          storageLimit:
                            description: PVC Expansion Limit
                            type: integer
                          threshold:
                            description: Threshold for starting PVC expansion
                            type: integer
                        type: object
                      backupVol:
                        description: Backup volume section
                        properties:
                          accessModes:
                            description: ' accessModes for backup volume: Specified
                              as an array of accessModes e.g. [ReadWriteMany]. If
                              omitted, it will be treated as [ReadWriteOnce]'
                            items:
                              type: string
                            type: array
                          increase:
                            description: PVC Expansion Amount
                            type: integer
                          increaseType:
                            description: Method for estimating PVC expansion amount
                            enum:
                            - percent
                            - size
                            type: string
                          size:
                            default: 2Gi
                            description: Size of backup volume.The storage volumes
                              size can be increased provided underlying storage supports
                              the operation
                            pattern: ^(\d+(e\d+)?|\d+(\.\d+)?(e\d+)?[EPTGMK]i?)$
                            type: string
                          storageClass:
                            description: 'StorageClass for backup volume: When this
                              line is omitted, the PV created will use default storage
                              class in the Kubernetes cluster'
                            type: string
                          storageLimit:
                            description: PVC Expansion Limit
                            type: integer
                          threshold:
                            description: Threshold for starting PVC expansion
                            type: integer
                        type: object
                      dataSize:
                        description: Size of the data to be stored. Estimate the size
                          of a volume with no defined size from this value.
                        pattern: ^([+-]?[0-9.]+)([eEinumkKMGTP]*[-+]?[0-9]*)$
                        type: string
                      dataVol:
                        description: data volume section
                        properties:
                          accessModes:
                            description: ' accessModes for data volume: Specified
                              as an array of accessModes e.g. [ReadWriteMany]. If
                              omitted, it will be treated as [ReadWriteOnce]'
                            items:
                              type: string
                            type: array
                          increase:
                            description: PVC Expansion Amount
                            type: integer
                          increaseType:
                            description: Method for estimating PVC expansion amount
                            enum:
                            - percent
                            - size
                            type: string
                          size:
                            default: 2Gi
                            description: Size of data volume.The storage volumes size
                              can be increased provided underlying storage supports
                              the operation
                            pattern: ^(\d+(e\d+)?|\d+(\.\d+)?(e\d+)?[EPTGMK]i?)$
                            type: string
                          storageClass:
                            description: 'StorageClass for data volume: When this
                              line is omitted, the PV created will use default storage
                              class in the Kubernetes cluster'
                            type: string
                          storageLimit:
                            description: PVC Expansion Limit
                            type: integer
                          threshold:
                            description: Threshold for starting PVC expansion
                            type: integer
                        type: object
                      logVol:
                        description: log volume section
                        properties:
                          accessModes:
                            description: ' accessModes for log volume: Specified as
                              an array of accessModes e.g. [ReadWriteMany]. If omitted,
                              it will be treated as [ReadWriteOnce]'
                            items:
                              type: string
                            type: array
                          increase:
                            description: PVC Expansion Amount
                            type: integer
                          increaseType:
                            description: Method for estimating PVC expansion amount
                            enum:
                            - percent
                            - size
                            type: string
                          size:
                            default: 1Gi
                            description: Size of log volume.The storage volumes size
                              can be increased provided underlying storage supports
                              the operation
                            pattern: ^(\d+(e\d+)?|\d+(\.\d+)?(e\d+)?[EPTGMK]i?)$
                            type: string
                          storageClass:
                            description: 'StorageClass for log volume: When this line
                              is omitted, the PV created will use default storage
                              class in the Kubernetes cluster'
                            type: string
                          storageLimit:
                            description: PVC Expansion Limit
                            type: integer
                          threshold:
                            description: Threshold for starting PVC expansion
                            type: integer
                        type: object
                      storageClass:
                        description: 'StorageClass for Volumes with no storageClass
                          defined: When this line is omitted, the PV created will
                          use default storage class in the Kubernetes cluster'
                        type: string
                      tablespaceVol:
                        description: tablespace volume section
                        properties:
                          accessModes:
                            description: ' accessModes for table volume: Specified
                              as an array of accessModes e.g. [ReadWriteMany]. If
                              omitted, it will be treated as [ReadWriteOnce]'
                            items:
                              type: string
                            type: array
                          increase:
                            description: PVC Expansion Amount
                            type: integer
                          increaseType:
                            description: Method for estimating PVC expansion amount
                            enum:
                            - percent
                            - size
                            type: string
                          size:
                            default: 512Mi
                            description: Size of table volume.The storage volumes
                              size can be increased provided underlying storage supports
                              the operation
                            pattern: ^(\d+(e\d+)?|\d+(\.\d+)?(e\d+)?[EPTGMK]i?)$
                            type: string
                          storageClass:
                            description: 'StorageClass for table volume: When this
                              line is omitted, the PV created will use default storage
                              class in the Kubernetes cluster'
                            type: string
                          storageLimit:
                            description: PVC Expansion Limit
                            type: integer
                          threshold:
                            description: Threshold for starting PVC expansion
                            type: integer
                        type: object
                      walVol:
                        description: wal volume section
                        properties:
                          accessModes:
                            description: ' accessModes for wal volume: Specified as
                              an array of accessModes e.g. [ReadWriteMany]. If omitted,
                              it will be treated as [ReadWriteOnce]'
                            items:
                              type: string
                            type: array
                          increase:
                            description: PVC Expansion Amount
                            type: integer
                          increaseType:
                            description: Method for estimating PVC expansion amount
                            enum:
                            - percent
                            - size
                            type: string
                          size:
                            default: 1200Mi
                            description: Size of wal volume.The storage volumes size
                              can be increased provided underlying storage supports
                              the operation
                            pattern: ^(\d+(e\d+)?|\d+(\.\d+)?(e\d+)?[EPTGMK]i?)$
                            type: string
                          storageClass:
                            description: 'StorageClass for wal volume: When this line
                              is omitted, the PV created will use default storage
                              class in the Kubernetes cluster'
                            type: string
                          storageLimit:
                            description: PVC Expansion Limit
                            type: integer
                          threshold:
                            description: Threshold for starting PVC expansion
                            type: integer
                        type: object
                    type: object
                  sysTde:
                    description: Not required if using FEP built-in key management
                      for TDE. Required if using an external Key Management System
                      (KMS) for TDE encryption key.
                    properties:
                      tdeType:
                        description: Defines the type of external Key Management System
                          (KMS) to store the encryption key for TDE
                        enum:
                        - tdeh
                        - tdek
                        type: string
                      tdeh:
                        description: Defines the configuration with using HPCS for
                          encryption key.
                        properties:
                          address:
                            description: HPCS ep11 server address
                            type: string
                          apikeyAnonymous:
                            description: Apikey of Anonymous User
                            type: string
                          apikeyNormal:
                            description: Apikey of Normal User
                            type: string
                          apikeySo:
                            description: Apikey of SO User
                            type: string
                          endpoint:
                            description: https://iam.cloud.ibm.com
                            type: string
                          instanceId:
                            description: HPCS instance ID
                            type: string
                          label:
                            description: Label for the HPCS token
                            type: string
                          loglevel:
                            description: 'Supported logging levels: panic, fatal,
                              error, warning/warn, info, debug, trace. Set to warning
                              by default when not defined'
                            type: string
                          port:
                            description: port
                            type: string
                          proxy:
                            description: http and https proxy settings if required
                              to connect to HPCS instance
                            type: string
                          tokenspaceidAnonymous:
                            description: 128-bit UUID for Anonymous user
                            type: string
                          tokenspaceidNormal:
                            description: 128-bit UUID for Normal user
                            type: string
                        type: object
                        x-kubernetes-preserve-unknown-fields: true
                      tdek:
                        description: Defines the configuraion with using KMIP for
                          encryption key.
                        type: object
                        x-kubernetes-preserve-unknown-fields: true
                    type: object
                  sysUsers:
                    description: users and password definition
                    properties:
                      passwordValid:
                        description: Valid days for pgadminpassword
                        properties:
                          days:
                            description: No of days for pgadminpassword expiration
                            x-kubernetes-preserve-unknown-fields: true
                        type: object
                      pgAdminPassword:
                        description: Optional password for user postgres. If omitted,
                          operator generates a random password
                        type: string
                      pgAdminTls:
                        description: Tls section for Postgres User
                        properties:
                          caName:
                            description: This points to Kubernetes configmap that
                              contains additional CA the client use to verify a server
                              certificate. The CA is stored in the key ca.crt
                            type: string
                          certificateName:
                            description: This points to Kubernetes TLS secret that
                              contains the certificate of Postgres user postgres.
                              Patroni will use this for certificate authentication.
                              The certificate itself is stored in the key tls.crt
                            type: string
                          sslMode:
                            description: ' Specify the type of TLS negotiation when
                              Patroni connects to FEP server. (disable/allow/prefer/require/verify-ca/verify-full)'
                            enum:
                            - disable
                            - allow
                            - prefer
                            - required
                            - verify-ca
                            - verify-full
                            type: string
                        type: object
                      pgMetricsPassword:
                        description: Optional password string for pgMetricsUser. If
                          omitted, operator generates a random password
                        type: string
                      pgMetricsUser:
                        description: user for FEPExporter connection
                        type: string
                      pgMetricsUserTls:
                        description: Tls section for pgMetricsUser
                        properties:
                          caName:
                            description: This points to Kubernetes configmap that
                              contains additional CA the client use to verify a server
                              certificate. The CA is stored in the key ca.crt
                            type: string
                          certificateName:
                            description: This points to Kubernetes TLS secret that
                              contains the certificate of pgMetricsUser. FEPExporter
                              will use this for certificate authentication. The certificate
                              itself is stored in the key tls.crt
                            type: string
                          sslMode:
                            description: ' Specify the type of TLS negotiation with
                              server. (disable/allow/prefer/require/verify-ca/verify-full)'
                            enum:
                            - disable
                            - allow
                            - prefer
                            - required
                            - verify-ca
                            - verify-full
                            type: string
                        type: object
                      pgRewindPassword:
                        description: Optional password string for database user pgRewindUser.
                          If omitted, operator generates a random password
                        type: string
                      pgRewindUser:
                        description: Database user for Rewind operation
                        type: string
                      pgRewindUserTls:
                        description: Tls section for pgRewindUser
                        properties:
                          caName:
                            description: This points to Kubernetes configmap that
                              contains additional CA the client use to verify a server
                              certificate. The CA is stored in the key ca.crt
                            type: string
                          certificateName:
                            description: This points to Kubernetes TLS secret that
                              contains the certificate of Postgres user rewinduser.
                              Patroni will use this for certificate authentication.
                              The certificate itself is stored in the key tls.crt
                            type: string
                          sslMode:
                            description: ' Specify the type of TLS negotiation with
                              server. (disable/allow/prefer/require/verify-ca/verify-full)'
                            enum:
                            - disable
                            - allow
                            - prefer
                            - required
                            - verify-ca
                            - verify-full
                            type: string
                        type: object
                      pgSecurityUser:
                        description: Security user
                        type: string
                      pgSeurityPassword:
                        description: Security user password
                        type: string
                      pgdb:
                        description: Database to be created during provisioning
                        type: string
                      pgpassword:
                        description: Optional password for database user pguser. If
                          omitted, operator generates a random password
                        type: string
                      pgreplUserTls:
                        description: Tls section for  pgreplUser
                        properties:
                          caName:
                            description: This points to Kubernetes configmap that
                              contains additional CA the client use to verify a server
                              certificate. The CA is stored in the key ca.crt
                            type: string
                          certificateName:
                            description: This points to Kubernetes TLS secret that
                              contains the certificate of Postgres user repluser.
                              Patroni will use this for certificate authentication.
                              The certificate itself is stored in the key tls.crt
                            type: string
                          sslMode:
                            description: ' Specify the type of TLS negotiation when
                              Patroni connects to FEP server. (disable/allow/prefer/require/verify-ca/verify-full)'
                            enum:
                            - disable
                            - allow
                            - prefer
                            - required
                            - verify-ca
                            - verify-full
                            type: string
                        type: object
                      pgreplpassword:
                        description: Optional password for database user pgrepluser.
                          If omitted, operator generates a random password
                        type: string
                      pgrepluser:
                        description: Database user for replication
                        type: string
                      pguser:
                        description: Database user to be created during provisioning
                        type: string
                      tdepassphrase:
                        description: TDE keystore passphrase
                        type: string
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  systemCertificates:
                    description: Server certificate section
                    properties:
                      cacrt:
                        description: Contains CA certificate for server
                        type: string
                      crt:
                        description: Contains certificate for server
                        type: string
                      key:
                        description: Contains certificate key for server
                        type: string
                    type: object
                type: object
                x-kubernetes-preserve-unknown-fields: true
              ldap:
                description: LDAP configuation for FEP
                properties:
                  caConfigMapRef:
                    description: |
                      If LDAP server certificate is signed by a private CA, this key should point to a configmap that has the chain of certificates that ldap2pg and FEP should trust.
                      FEP Operator expects the key name in the configmap be ca.crt(1).
                      (1) When spec.ldap.caConfigMapRef is defined, and the referenced configmap exist, the named configmap will be mounted on fep-patroni under /tls/ldap.
                    type: string
                  ldapconfSecretRef:
                    description: |
                      Name of secret that contains the ldap.conf
                      When spec.ldap is defined but spec.ldap.ldapconfSecretRef is not defined, FEP Operator will create a default secret <fep-cluster>-ldapconf(2).
                      FEP Operator expects the key name in the secret be ldap.conf.
                      (2) When the referenced secret spec.ldap.ldapconfSecretRef exists, the named secret will be mounted on fep-patroni under /etc/openldap. The environment variable LDAPCONF=/etc/openldap/ldap.conf will be exported to the fep-patroni container. If this key is not defined, Operator will create and mount default secret <fep-cluster>-ldapconf with the following content.
                    type: string
                type: object
                x-kubernetes-preserve-unknown-fields: true
              ldap2pg:
                description: Option to enable ldap2pg in FEP
                properties:
                  enable:
                    description: Setting this to “true” (default) will enable ldap2pg
                      to execute periodically according to schedule defined. Setting
                      this to “false” will remove the cronjob that execute the ldap2pg.
                    type: boolean
                  ldap2pgymlConfigMapRef:
                    description: |
                      Name of configmap that contains the ldap2pg.yml
                      When spec.ldap2pg is defined but spec.ldap2pg.ldap2pgymlConfigMapRef is not defined, FEP Operator will create a default configmap <fep-cluster>-ldap2pgyml(3).
                      FEP Operator expects the key name in the configmap be ldap2pg.yml.
                      (3) When the referenced configmap spec.ldap2pg.ldap2pgymlConfigMapRef exists, the named configmap will be mounted on fep-patroni under /tmp/.config. If the secret does not exist, Operator will create that named secret with the following content.
                    type: string
                  mode:
                    description: Whether ldap2pg should run in “check mode” (default)
                      or “real” mode. If not defined, ldap2pg will run in check mode.
                    enum:
                    - check
                    - real
                    type: string
                  schedule:
                    description: |
                      schedule to execute ldap2pg in a crontab format.
                      If defined, Operator will create a cronjob using fep-cronjob container and remote execute ldap2pg on fep-patroni container on a regular basis.
                    type: string
                type: object
                x-kubernetes-preserve-unknown-fields: true
              restoreMode:
                description: Flag for restore
                type: string
            type: object
          status:
            description: Status defines the observed state of FEPCluster
            type: object
            x-kubernetes-preserve-unknown-fields: true
        type: object
    served: true
    storage: true
    subresources:
      scale:
        labelSelectorPath: .status.fepLabelSelector
        specReplicasPath: .spec.fep.instances
        statusReplicasPath: .status.fepCurrentInstances
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: null
  storedVersions: null

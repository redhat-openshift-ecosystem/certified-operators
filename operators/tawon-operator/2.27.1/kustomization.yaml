resources:
  - manifests/tawon-operator.clusterserviceversion.yaml

# This serviceaccount is attach to the tawon daemonset / deployments.
# tawon has privileged capabilities, like mounting hostPath volumes, load bpf programs, etc.
# TODO create a custom scc for its tawon serviceaccount.
patchesJson6902:
  - target:
      group: operators.coreos.com
      version: v1alpha1
      kind: ClusterServiceVersion
      name: tawon-operator.v2.27.1
    patch: |-
      - op: add
        path: "/spec/install/spec/clusterPermissions/-"
        value:
            rules:
              - apiGroups: ["security.openshift.io"]
                resourceNames: ["privileged"]
                resources: ["securitycontextconstraints"]
                verbs: ["use"]
            serviceAccountName: "default"
  - target:
      group: operators.coreos.com
      version: v1alpha1
      kind: ClusterServiceVersion
      name: tawon-operator.v2.27.1
    patch: |-
      - op: add
        path: "/spec/relatedImages/-"
        value:
          image: quay.io/mantisnet/tawon@sha256:ad19c040abcf8145d3a196c23ced75ddef898c6f241e6758012fc16b611cd299
          name: tawon
  - target:
      group: operators.coreos.com
      version: v1alpha1
      kind: ClusterServiceVersion
      name: tawon-operator.v2.27.1
    patch: |-
      - op: add
        path: "/spec/relatedImages/-"
        value:
          image: quay.io/mantisnet/nats@sha256:6afc7ced92181a7c12d709e9693740847297dc5d60ab78cbac7b9b6c859ecdd1
          name: nats
  - target:
      group: operators.coreos.com
      version: v1alpha1
      kind: ClusterServiceVersion
      name: tawon-operator.v2.27.1
    patch: |-
      - op: add
        path: "/spec/relatedImages/-"
        value:
          image: quay.io/mantisnet/kernel-headers@sha256:242e837af831b6eed98d522b6bae7416928b9fbe451fb6e02ffa678686771068
          name: kernel-headers-ocp-4.12.29
  - target:
      group: operators.coreos.com
      version: v1alpha1
      kind: ClusterServiceVersion
      name: tawon-operator.v2.27.1
    patch: |-
      - op: add
        path: "/spec/relatedImages/-"
        value:
          image: quay.io/mantisnet/kernel-headers@sha256:2aa3bc7871fe0fc0a79ac812d941e55cd0d25a5f0d1d9b3e2435aab6f3d70c67
          name: kernel-headers-ocp-4.14.0-rc1

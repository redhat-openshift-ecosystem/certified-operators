apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: webservers.example.com
spec:
  group: example.com
  names:
    kind: WebServer
    listKind: WebServerList
    plural: webservers
    singular: webserver
  scope: Namespaced
  versions:
    - name: v1alpha1
      served: true
      storage: true
      schema:
        openAPIV3Schema:
          type: object
          description: WebServer is the Schema for the webservers API
          properties:
            apiVersion:
              type: string
            kind:
              type: string
            metadata:
              type: object
            spec:
              type: object
              properties:
                type:
                  type: string
                  description: "Web server type: nginx or apache/httpd"
                  enum: ["nginx", "apache", "httpd"]
                replicas:
                  type: integer
                  minimum: 1
                  default: 1
                port:
                  type: integer
                  minimum: 1
                  maximum: 65535
                  default: 8080
                image:
                  type: string
                  description: Optional override image for the selected server type
                contentConfigMapName:
                  type: string
                  description: >-
                    Optional ConfigMap in the same namespace that contains custom web content.
                    For custom content to activate, the ConfigMap must include an `index.html` key.
                    Optional `style.css` key is supported.
              required:
                - type
            status:
              type: object
              x-kubernetes-preserve-unknown-fields: true
      subresources:
        status: {}
